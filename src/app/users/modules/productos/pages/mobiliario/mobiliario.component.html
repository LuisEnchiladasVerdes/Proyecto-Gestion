<div class="flex flex-col items-center bg-gray-200 pt-20 pb-10">
  <h2 class="text-3xl font-bold mb-4 pt-5 font-roboto">CATÁLOGO</h2>

  <div class="flex ms-auto items-start me-5 pe-4 py-3">
    <div class="relative">
      <select
        id="category"
        name="category"
        [(ngModel)]="categoriaSeleccionada"
        (change)="filterProductosPorCategoria()"
        class="mt-1 block w-full px-3 py-2 border bg-white text-black rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"
      >
        <option value="">Todas las categorías</option>
        <option *ngFor="let categoria of categorias" [value]="categoria.id">
          {{ categoria.nombre }}
        </option>
        <option value="paquetes">Paquetes</option>
      </select>
    </div>
  </div>

  <div class="px-12 grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4">
    <div
      class="group bg-white rounded-lg shadow-sm overflow-hidden h-[400px] relative mb-3 hover:shadow-md transform hover:scale-105 transition-all duration-300"
      *ngFor="let producto of productos"
    >
      <!-- Contenedor de la imagen -->
      <div class="w-full h-[250px] relative overflow-hidden">
        <img
          class="w-full h-full object-cover group-hover:opacity-70 transition-opacity duration-300"
          [src]="mediaBaseUrl + producto.media_relacionado[0]"
          alt="{{ producto.nombre }}"
        />
        <!-- Descripción sobre la imagen -->
        <div
          class="absolute inset-0 bg-black bg-opacity-50 text-white opacity-0 group-hover:opacity-100 flex flex-col justify-center items-center text-center transition-opacity duration-300"
        >
          <h3 class="text-lg font-bold mb-2">{{ producto.nombre }}</h3>
          <p class="text-sm mb-1">{{ producto.descripcion }}</p>
          <br>
          <p class="text-sm pb-2">Categoría: {{ producto.categoria.nombre }}</p>

          <button
            class="w-auto px-3 py-1 bg-gray-700 text-white rounded-md text-sm flex items-center gap-1 shadow-md hover:bg-gray-800 hover:shadow-lg transition-all duration-300"
            (click)="openDetailsModal(producto, 'producto')"
          >
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor">
              <path d="M10 2a8 8 0 11-.001 16.001A8 8 0 0110 2zm0 14a6 6 0 100-12 6 6 0 000 12z" />
              <path d="M10 5a5 5 0 00-4.546 2.916A5 5 0 0110 5zm0 10a5 5 0 004.546-2.916A5 5 0 0110 15z" />
            </svg>
            <span>Ver detalles</span>
          </button>
        </div>

      </div>

      <!-- Contenido de la card con padding -->
      <div class="px-4 py-3">
        <!-- Información del producto -->
        <div class="text-lg font-medium text-gray-900">{{ producto.nombre }}</div>
        <div class="text-sm font-medium text-gray-900">${{ producto.precio_actual }}</div>

        <!-- Botón de agregar que aparece en hover -->
        <div
          class="absolute bottom-4 left-4 right-4 opacity-0 group-hover:opacity-100 transition-all duration-300 transform translate-y-2 group-hover:translate-y-0"
        >
          <button
            class="w-full bg-teal-600 hover:bg-teal-700 text-white py-2 px-4 rounded-md font-medium flex items-center justify-center gap-2"
            (click)="addToCart(producto)"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="h-5 w-5"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"
              />
            </svg>
            Agregar al carrito
          </button>
        </div>
      </div>
    </div>

    <div
      class="group bg-white rounded-lg shadow-sm overflow-hidden h-[400px] relative mb-3 hover:shadow-md transform hover:scale-105 transition-all duration-300"
      *ngFor="let paquete of paquetes"
    >
      <!-- Contenedor de la imagen -->
      <div class="w-full h-[250px] relative overflow-hidden">
        <img
          class="w-full h-full object-cover group-hover:opacity-70 transition-opacity duration-300"
          [src]="mediaBaseUrl + paquete.media_urls![0]"
          alt="{{ paquete.nombre }}"
        />
        <!-- Descripción sobre la imagen -->
        <div
          class="absolute inset-0 bg-black bg-opacity-50 text-white opacity-0 group-hover:opacity-100 flex flex-col justify-center items-center text-center transition-opacity duration-300"
        >
          <h3 class="text-lg font-bold mb-2">{{ paquete.nombre }}</h3>
          <p class="text-sm mb-1">{{ paquete.descripcion }}</p>
          <br>
          <p class="text-sm">Categoría: Paquete</p>

          <button
            class="w-auto px-3 py-1 bg-gray-700 text-white rounded-md text-sm flex items-center gap-1 shadow-md hover:bg-gray-800 hover:shadow-lg transition-all duration-300"
            (click)="openDetailsModal(paquete, 'paquete')"
          >
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor">
              <path d="M10 2a8 8 0 11-.001 16.001A8 8 0 0110 2zm0 14a6 6 0 100-12 6 6 0 000 12z" />
              <path d="M10 5a5 5 0 00-4.546 2.916A5 5 0 0110 5zm0 10a5 5 0 004.546-2.916A5 5 0 0110 15z" />
            </svg>
            <span>Ver detalles</span>
          </button>
        </div>

      </div>

      <!-- Contenido de la card con padding -->
      <div class="px-4 py-3">
        <!-- Información del producto -->
        <div class="text-lg font-medium text-gray-900">{{ paquete.nombre }}</div>
        <div class="text-sm font-medium text-gray-900">${{ paquete.precio_final }}</div>

        <!-- Botón de agregar que aparece en hover -->
        <div
          class="absolute bottom-4 left-4 right-4 opacity-0 group-hover:opacity-100 transition-all duration-300 transform translate-y-2 group-hover:translate-y-0"
        >
          <button
            class="w-full bg-teal-600 hover:bg-teal-700 text-white py-2 px-4 rounded-md font-medium flex items-center justify-center gap-2"
            (click)="addPaqueteToCart(paquete)"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="h-5 w-5"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"
              />
            </svg>
            Agregar al carrito
          </button>
        </div>
      </div>

    </div>

  </div>
</div>



<!-- Modal -->
<div *ngIf="showDetailsModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
  <div class="bg-white rounded-lg shadow-lg w-full max-w-3xl p-6 relative">
    <!-- Botón para cerrar el modal -->
    <button
      (click)="closeDetailsModal()"
      class="absolute top-2 right-2 bg-red-500 text-white rounded-full w-8 h-8 flex items-center justify-center"
    >
      &times;
    </button>

    <!-- Contenido del Modal -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <!-- Imágenes -->
      <div *ngIf="selectedType === 'producto'">
        <img
          *ngFor="let img of selectedItem.media_relacionado; let i = index"
          [src]="mediaBaseUrl + img"
          alt="Imagen del producto"
          class="w-full rounded-lg mb-2"
        />
      </div>

      <div *ngIf="selectedType === 'paquete'">
        <img
          *ngFor="let img of selectedItem.media_urls; let i = index"
          [src]="mediaBaseUrl + img"
          alt="Imagen del paquete"
          class="w-full rounded-lg mb-2"
        />
      </div>

      <!-- Detalles del Producto/Paquete -->
      <div>
        <h2 class="text-2xl font-bold mb-2">{{ selectedItem.nombre }}</h2>
        <p class="text-gray-600 mb-4">{{ selectedItem.descripcion }}</p>
        <p class="text-sm text-gray-800"><strong>Categoría:</strong> {{ selectedItem.categoria?.nombre || 'Paquete' }}</p>
        <p class="text-lg font-bold text-gray-900 mt-2">Precio: ${{ selectedItem.precio_actual || selectedItem.precio_final }}</p>

        <!-- Botón Agregar al Carrito -->
        <button
          class="mt-6 bg-teal-600 hover:bg-teal-700 text-white py-2 px-4 rounded-md font-medium w-full"
          (click)="addItemToCart(selectedItem, selectedType)"
        >
          Agregar al carrito
        </button>
      </div>
    </div>
  </div>
</div>
